(function(n){"use strict";function r(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function f(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}}function i(n,t,i){for(var r=[],u=0;u<i;++u)r.push(anime.random(n,t));return r.sort(function(n,t){return n-t}),r}function u(n){return Object.getOwnPropertyNames(n).length>0}function e(){for(var t,i={},r=arguments.length,n=0;n<r;n++)for(t in arguments[n])arguments[n].hasOwnProperty(t)&&(i[t]=arguments[n][t]);return i}function o(){for(var o,t,i="clipPath",e=["webkit","moz","ms","o"],r=[i],u=document.createElement("testelement"),n=0,f=e.length;n<f;n++)o=e[n]+i.charAt(0).toUpperCase()+i.slice(1),r.push(o);for(n=0,f=r.length;n<f;n++)if(t=r[n],u.style[t]===""&&(u.style[t]="polygon(50% 0%, 0% 100%, 100% 100%)",u.style[t]!==""))return!0;return!1}function t(n,t){this.el=n;this.options=r({},this.options);r(this.options,t);var i=this;imagesLoaded(this.el,{background:!0},function(){i._init();i._initEvents();i.options.onReady()})}t.prototype.options={pieces:4,renderOnLoad:!1,shadows:!0,shadowsAnimation:{opacity:1},parallax:!1,parallaxMovement:{min:10,max:40},animation:{duration:1500,easing:"easeOutQuad",delay:0,translateZ:{min:10,max:65}},onReady:function(){return!1},onAnimationComplete:function(){return!1},onAnimationStart:function(){return!1},positions:[{top:80,left:10,width:30,height:20},{top:2,left:2,width:40,height:40},{top:30,left:60,width:30,height:60},{top:10,left:20,width:50,height:60}]};t.prototype._init=function(){var t,n;this.dimensions={width:this.el.offsetWidth,height:this.el.offsetHeight};t=this.el.style.backgroundImage;this.imgsrc=t.replace("url(","").replace(")","").replace(/\"/gi,"");this._layout();n=this;this.pieces=[].slice.call(this.el.querySelectorAll(".segmenter__piece-wrap"));this.pieces.forEach(function(t){t.style.WebkitTransform=t.style.transform="translateZ(0.0001px)";n.options.renderOnLoad&&n._renderPiece(t)});this.options.renderOnLoad&&(this.active=!0)};t.prototype._layout=function(){var v=o(),l=document.createElement("div"),s,y,n,t,f,e,h,c,p,w,i,r;l.className="segmenter__background";l.style.backgroundImage="url("+this.imgsrc+")";var a=document.createElement("div"),u="",b=this.options.positions.length;for(a.className="segmenter__pieces",s=0,y=this.options.pieces;s<y;++s)this.options.parallax&&(u+='<div class="segmenter__piece-parallax">'),u+='<div class="segmenter__piece-wrap">',i=s<=b-1?s:0,r=this.options.positions==="random",n=r?anime.random(0,100):this.options.positions[i].top,t=r?anime.random(0,100):this.options.positions[i].left,f=r?anime.random(0,100):this.options.positions[i].width,e=r?anime.random(0,100):this.options.positions[i].height,v||(h=r?n/100*this.dimensions.height:this.options.positions[i].top/100*this.dimensions.height,c=r?t/100*this.dimensions.width:this.options.positions[i].left/100*this.dimensions.width,p=r?f/100*this.dimensions.width+c:this.options.positions[i].width/100*this.dimensions.width+c,w=r?e/100*this.dimensions.height+h:this.options.positions[i].height/100*this.dimensions.height+h),this.options.shadows&&(u+='<div class="segmenter__shadow" style="top: '+n+"%; left: "+t+"%; width: "+f+"%; height: "+e+'%"><\/div>'),u+=v?'<div class="segmenter__piece" style="background-image: url('+this.imgsrc+"); -webkit-clip-path: polygon("+t+"% "+n+"%, "+(t+f)+"% "+n+"%, "+(t+f)+"% "+(n+e)+"%, "+t+"% "+(n+e)+"%); clip-path: polygon("+t+"% "+n+"%, "+(t+f)+"% "+n+"%, "+(t+f)+"% "+(n+e)+"%, "+t+"% "+(n+e)+'%)"><\/div>':'<div class="segmenter__piece" style="background-image: url('+this.imgsrc+"); clip: rect("+h+"px,"+p+"px,"+w+"px,"+c+'px)"><\/div>',u+="<\/div>",this.options.parallax&&(u+="<\/div>");a.innerHTML=u;this.el.innerHTML="";this.el.appendChild(l);this.el.appendChild(a)};t.prototype._renderPiece=function(n){var f=this.pieces.indexOf(n),t,r;self.options.animation.translateZ!=undefined&&(typeof self.options.animation.translateZ=="object"?(t=i(self.options.animation.translateZ.min,self.options.animation.translateZ.max,self.options.pieces),n.style.transform=n.style.WebkitTransform="translateZ("+t[f]+"px)"):n.style.transform=n.style.WebkitTransform="translateZ("+self.options.animation.translateZ+"px)");self.options.animation.translateY!=undefined&&(typeof self.options.animation.translateY=="object"?(t=i(self.options.animation.translateY.min,self.options.animation.translateY.max,self.options.pieces),n.style.transform=n.style.WebkitTransform="translateY("+t[f]+"px)"):n.style.transform=n.style.WebkitTransform="translateY("+self.options.animation.translateY+"px)");self.options.animation.translateX!=undefined&&(typeof self.options.animation.translateX=="object"?(t=i(self.options.animation.translateX.min,self.options.animation.translateX.max,self.options.pieces),n.style.transform=n.style.WebkitTransform="translateX("+t[f]+"px)"):n.style.transform=n.style.WebkitTransform="translateX("+self.options.animation.translateX+"px)");self.options.animation.opacity!=undefined&&(n.style.opacity=self.options.animation.opacity);self.options.shadows&&u(self.options.shadowsAnimation)&&(r=n.querySelector(".segmenter__shadow"),r.style.opacity=self.options.shadowsAnimation.opacity!=undefined?self.options.shadowsAnimation.opacity:0,r.style.transform=r.style.WebkitTransform="translateX("+(self.options.shadowsAnimation.translateX!=undefined?self.options.shadowsAnimation.translateX:0)+"px) translateY("+(self.options.shadowsAnimation.translateY!=undefined?self.options.shadowsAnimation.translateY:0)+"px)")};t.prototype.animate=function(){var n,t,r;if(this.active)return!1;this.active=!0;n=this;t={targets:this.pieces,duration:this.options.animation.duration,delay:function(t,i){return(n.options.pieces-i-1)*n.options.animation.delay},easing:this.options.animation.easing,begin:this.options.onAnimationStart,complete:this.options.onAnimationComplete};this.options.animation.translateZ!=undefined&&(r=i(this.options.animation.translateZ.min,this.options.animation.translateZ.max,this.options.pieces),t.translateZ=typeof this.options.animation.translateZ=="object"?function(n,t){return r[t]}:this.options.animation.translateZ);this.options.animation.translateX!=undefined&&(t.translateX=typeof this.options.animation.translateX=="object"?function(){return anime.random(n.options.animation.translateX.min,n.options.animation.translateX.max)}:this.options.animation.translateX);this.options.animation.translateY!=undefined&&(t.translateY=typeof this.options.animation.translateY=="object"?function(){return anime.random(n.options.animation.translateY.min,n.options.animation.translateY.max)}:this.options.animation.translateY);this.options.animation.opacity!=undefined&&(t.opacity=this.options.animation.opacity);anime(t);this.options.shadows&&u(this.options.shadowsAnimation)&&anime(e({targets:this.el.querySelectorAll(".segmenter__shadow"),duration:this.options.animation.duration,delay:function(t,i){return(n.options.pieces-i-1)*n.options.animation.delay},easing:this.options.animation.easing},this.options.shadowsAnimation))};t.prototype._initEvents=function(){var t=this,r;this.debounceResize=f(function(){var n=t.options.positions.length;t.dimensions={width:t.el.offsetWidth,height:t.el.offsetHeight};t.pieces.forEach(function(i,r){var u,f,o,s,h=i.querySelector(".segmenter__piece"),e;if(t.options.positions==="random"){var c=anime.random(0,100),l=anime.random(0,100),a=anime.random(0,100),v=anime.random(0,100);u=c/100*t.dimensions.height;f=l/100*t.dimensions.width;o=a/100*t.dimensions.width+f;s=v/100*t.dimensions.height+u}else e=r<=n-1?r:0,u=t.options.positions[e].top/100*t.dimensions.height,f=t.options.positions[e].left/100*t.dimensions.width,o=t.options.positions[e].width/100*t.dimensions.width+f,s=t.options.positions[e].height/100*t.dimensions.height+u;h.style.clip="rect("+u+"px,"+o+"px,"+s+"px,"+f+"px)"})},10);n.addEventListener("resize",this.debounceResize);this.options.parallax&&(r=i(this.options.parallaxMovement.min,this.options.parallaxMovement.max,this.options.pieces),this.pieces.forEach(function(n,i){n.setAttribute("data-parallax-translation",typeof t.options.parallaxMovement=="object"?r[i]:t.options.parallaxMovement)}),this.mousemove=function(n){if(!t.active)return!1;requestAnimationFrame(function(){t.pieces.forEach(function(i){var r=i.getAttribute("data-parallax-translation"),u=r/t.dimensions.width*n.clientX-r/2,f=r/t.dimensions.height*n.clientY-r/2;i.parentNode.style.transform=i.parentNode.style.WebkitTransform="translate3d("+u+"px,"+f+"px,0)"})})},n.addEventListener("mousemove",this.mousemove),this.handleOrientation=function(){if(!t.active)return!1;var n=event.gamma;n+=90;requestAnimationFrame(function(){t.pieces.forEach(function(i){var r=i.getAttribute("data-parallax-translation"),u=r/t.dimensions.width*n-r/2,f=r/t.dimensions.height*n-r/2;i.parentNode.style.transform=i.parentNode.style.WebkitTransform="translate3d("+u+"px,"+f+"px,0)"})})},n.addEventListener("deviceorientation",this.handleOrientation))};n.Segmenter=t})(window);